function loop(){window.requestAnimationFrame(loop),step(),draw()}function step(){++tick,lines.length<opts.lineCount&&Math.random()<.1&&lines.push(new Line),lines.map(function(a){a.step()})}function draw(){ctx.shadowBlur=0,ctx.globalCompositeOperation="source-over",ctx.fillStyle="rgba(0,0,0,alp)".replace("alp",opts.repaintAlpha),ctx.fillRect(0,0,w,h),ctx.globalCompositeOperation="lighter";var a=1*Math.random()*(Math.random()<.5?1:-1);ctx.translate(a,a),lines.map(function(a){a.draw()}),ctx.translate(-a,-a)}function Line(){this.reset()}var w=c.width=window.innerWidth,h=c.height=window.innerHeight,ctx=c.getContext("2d"),opts={lineCount:20,lineBaseLength:100,lineAddedLength:100,lineRelativeBaseEndWidth:.02,lineRelativeAddedEndWidth:.02,lineBaseTime:10,lineAddedTime:20,particleSpawnProb:.5,particleRelativeBaseSize:.8,particleRelativeAddedSize:.4,particleRelativeSpan:3,repaintAlpha:.04},lines=[],tick=0;ctx.fillStyle="#222",ctx.fillRect(0,0,w,h),Line.prototype.reset=function(){this.sx=this.px=this.x=Math.random()*w,this.sy=this.py=this.y=Math.random()*h;var a=opts.lineBaseLength+Math.random()*opts.lineAddedLength,b=Math.random()*Math.PI*2;this.dx=Math.cos(b)*a,this.dy=Math.sin(b)*a,this.width=0,this.targetWidth=(opts.lineRelativeBaseEndWidth+Math.random()*opts.lineRelativeAddedEndWidth)*a,this.time=0,this.targetTime=opts.lineBaseTime+Math.random()*opts.lineAddedTime|0},Line.prototype.step=function(){++this.time;var a=this.time/this.targetTime;this.x=this.sx+this.dx*a,this.y=this.sy+this.dy*a,this.width=Math.sin(a*Math.PI)*this.targetWidth,this.time>this.targetTime&&this.reset()},Line.prototype.draw=function(){if(ctx.lineWidth=this.width,ctx.strokeStyle="hsl(hue,80%,50%)".replace("hue",this.x/w*360+tick),ctx.beginPath(),ctx.moveTo(this.px,this.py),ctx.lineTo(this.x,this.y),ctx.stroke(),Math.random()<opts.particleSpawnProb){var a=(opts.particleRelativeBaseSize+Math.random()*opts.particleRelativeAddedSize)*this.width,b=opts.particleRelativeSpan*this.width;ctx.fillStyle=ctx.shadowColor=ctx.strokeStyle,ctx.shadowBlur=this.width,ctx.fillRect(this.x+Math.random()*b*(Math.random()<.5?1:-1),this.y+Math.random()*b*(Math.random()<.5?1:-1),a,a),ctx.shadowBlur=0}this.px=this.x,this.py=this.y},loop(),window.addEventListener("resize",function(){w=c.width=window.innerWidth,h=c.height=window.innerHeight,ctx.fillStyle="#222",ctx.fillRect(0,0,w,h)});